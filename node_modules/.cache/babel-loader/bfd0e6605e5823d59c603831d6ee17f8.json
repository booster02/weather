{"ast":null,"code":"import _regeneratorRuntime from\"/home/bela/TPL/frontend-challenges/js/03_react/weather/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/bela/TPL/frontend-challenges/js/03_react/weather/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/bela/TPL/frontend-challenges/js/03_react/weather/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useRef,useState}from\"react\";export function useFetch(url){var cache=useRef();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];useEffect(function(){function getData(){return _getData.apply(this,arguments);}function _getData(){_getData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,_response,_data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(url){_context.next=2;break;}return _context.abrupt(\"return\");case 2:if(!cache.current){_context.next=6;break;}response=cache.current;setData(response);return _context.abrupt(\"return\");case 6:_context.prev=6;_context.next=9;return fetch(url);case 9:_response=_context.sent;_context.next=12;return _response.json();case 12:_data=_context.sent;cache.current=_data;setData(_data);console.log(_data);_context.next=21;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](6);console.log(_context.t0);case 21:case\"end\":return _context.stop();}}},_callee,null,[[6,18]]);}));return _getData.apply(this,arguments);}void getData();return function(){setData(null);cache.current=null;};},[url]);return data;}export function useFetchLocation(url){var cache=useRef();var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];useEffect(function(){function getData(){return _getData2.apply(this,arguments);}function _getData2(){_getData2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var response,_response2,_data2;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(url){_context2.next=2;break;}return _context2.abrupt(\"return\");case 2:if(!cache.current){_context2.next=6;break;}response=cache.current;setData(response);return _context2.abrupt(\"return\");case 6:_context2.prev=6;_context2.next=9;return fetch(url);case 9:_response2=_context2.sent;_context2.next=12;return _response2.json();case 12:_data2=_context2.sent;cache.current=_data2;setData(_data2);_context2.next=20;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](6);console.log(_context2.t0);case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[6,17]]);}));return _getData2.apply(this,arguments);}void getData();return function(){setData(null);cache.current=null;};},[url]);return data;}","map":{"version":3,"names":["useEffect","useRef","useState","useFetch","url","cache","data","setData","getData","current","response","fetch","json","console","log","useFetchLocation"],"sources":["/home/bela/TPL/frontend-challenges/js/03_react/weather/src/utils/Hooks/useFetch.tsx"],"sourcesContent":["import {useEffect, useRef, useState} from \"react\";\n\ninterface responseItem {\n    daily: {\n        time: string[];\n        temperature_2m_max: number[];\n        temperature_2m_min: number[];\n    }\n    hourly: {\n        temperature_2m: number[];\n        weathercode: number[];\n        time: string[]\n    }\n}\n\nexport function useFetch(url: string | null) {\n    const cache = useRef<responseItem | null>()\n    const [data, setData] = useState<responseItem | null>(null);\n    useEffect(() => {\n        async function getData(): Promise<void> {\n            if (!url) return;\n            if (cache.current) {\n                const response = cache.current;\n                setData(response);\n                return;\n            }\n            try {\n                let response = await fetch(url);\n                let data = await response.json();\n                cache.current = data;\n                setData(data);\n                console.log(data);\n            } catch (e) {\n                console.log(e);\n            }\n        }\n\n        void getData();\n        return () => {\n            setData(null);\n            cache.current = null;\n        }\n    }, [url]);\n    return data;\n}\nexport interface cityInformation {\n    admin1: string,\n    admin1_id: number,\n    admin2?: string,\n    admin2_id?: number,\n    admin3?: string,\n    admin3_id?: number,\n    country: string,\n    country_code: string,\n    country_id: number,\n    elevation: number,\n    feature_code: string,\n    id: number,\n    latitude: number,\n    longitude: number,\n    name: string,\n    population: number\n}\nexport interface locationResponse {\n    results: [cityInformation],\n    generationtime_ms: number\n}\n\nexport function useFetchLocation(url: string) {\n    const cache = useRef<locationResponse | null>()\n    const [data, setData] = useState<locationResponse | null>(null);\n    useEffect(() => {\n        async function getData(): Promise<void> {\n            if (!url) return;\n            if (cache.current) {\n                const response = cache.current;\n                setData(response);\n                return;\n            }\n            try {\n                let response = await fetch(url);\n                let data = await response.json();\n                cache.current = data;\n                setData(data);\n            } catch (e) {\n                console.log(e);\n            }\n        }\n\n        void getData();\n        return () => {\n            setData(null);\n            cache.current = null;\n        }\n    }, [url]);\n    return data;\n}\n"],"mappings":"obAAA,OAAQA,SAAR,CAAmBC,MAAnB,CAA2BC,QAA3B,KAA0C,OAA1C,CAeA,MAAO,SAASC,SAAT,CAAkBC,GAAlB,CAAsC,CACzC,GAAMC,MAAK,CAAGJ,MAAM,EAApB,CACA,cAAwBC,QAAQ,CAAsB,IAAtB,CAAhC,wCAAOI,IAAP,eAAaC,OAAb,eACAP,SAAS,CAAC,UAAM,SACGQ,QADH,iIACZ,qKACSJ,GADT,qEAEQC,KAAK,CAACI,OAFd,yBAGcC,QAHd,CAGyBL,KAAK,CAACI,OAH/B,CAIQF,OAAO,CAACG,QAAD,CAAP,CAJR,8EAQ6BC,MAAK,CAACP,GAAD,CARlC,QAQYM,SARZ,sCASyBA,UAAQ,CAACE,IAAT,EATzB,SASYN,KATZ,eAUQD,KAAK,CAACI,OAAN,CAAgBH,KAAhB,CACAC,OAAO,CAACD,KAAD,CAAP,CACAO,OAAO,CAACC,GAAR,CAAYR,KAAZ,EAZR,iFAcQO,OAAO,CAACC,GAAR,cAdR,qEADY,0CAmBZ,IAAKN,QAAO,EAAZ,CACA,MAAO,WAAM,CACTD,OAAO,CAAC,IAAD,CAAP,CACAF,KAAK,CAACI,OAAN,CAAgB,IAAhB,CACH,CAHD,CAIH,CAxBQ,CAwBN,CAACL,GAAD,CAxBM,CAAT,CAyBA,MAAOE,KAAP,CACH,CAwBD,MAAO,SAASS,iBAAT,CAA0BX,GAA1B,CAAuC,CAC1C,GAAMC,MAAK,CAAGJ,MAAM,EAApB,CACA,eAAwBC,QAAQ,CAA0B,IAA1B,CAAhC,yCAAOI,IAAP,eAAaC,OAAb,eACAP,SAAS,CAAC,UAAM,SACGQ,QADH,oIACZ,4KACSJ,GADT,uEAEQC,KAAK,CAACI,OAFd,0BAGcC,QAHd,CAGyBL,KAAK,CAACI,OAH/B,CAIQF,OAAO,CAACG,QAAD,CAAP,CAJR,iFAQ6BC,MAAK,CAACP,GAAD,CARlC,QAQYM,UARZ,wCASyBA,WAAQ,CAACE,IAAT,EATzB,SASYN,MATZ,gBAUQD,KAAK,CAACI,OAAN,CAAgBH,MAAhB,CACAC,OAAO,CAACD,MAAD,CAAP,CAXR,qFAaQO,OAAO,CAACC,GAAR,eAbR,uEADY,2CAkBZ,IAAKN,QAAO,EAAZ,CACA,MAAO,WAAM,CACTD,OAAO,CAAC,IAAD,CAAP,CACAF,KAAK,CAACI,OAAN,CAAgB,IAAhB,CACH,CAHD,CAIH,CAvBQ,CAuBN,CAACL,GAAD,CAvBM,CAAT,CAwBA,MAAOE,KAAP,CACH"},"metadata":{},"sourceType":"module"}