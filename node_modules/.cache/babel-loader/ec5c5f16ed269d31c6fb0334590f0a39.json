{"ast":null,"code":"var _jsxFileName = \"/home/bela/TPL/frontend-challenges/js/03_react/weather/src/App.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport './App.css';\nimport \"./components/fore-cast\";\nimport { MainPart } from \"./components/main-part\";\nimport { CastType, ForeCast } from \"./components/fore-cast\";\nimport { useFetch, useFetchLocation } from \"./utils/Hooks/useFetch\";\nimport useLocation from \"./utils/Hooks/useLocation\";\nimport { getWeatherStatus, getWeatherType, WeatherType } from \"./utils/GetWeatherType\";\nimport { useInterval } from \"./utils/Hooks/useInterval\";\nimport { timeZoneOffset } from \"./utils/constant\";\nimport { addHours } from \"./utils/time/addHours\";\nimport { getDayPreviews, getHourPreviews } from \"./utils/previews/hourPreviews\";\nimport { getDayFromDate, getDayFromString } from \"./utils/time/formatTime\";\nimport { LocationBar } from \"./components/location-bar\";\nimport useDebounce from \"./utils/Hooks/useDebounce\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  const [currentTimeExact, setCurrentTimeExact] = useState(addHours(timeZoneOffset).toISOString().substring(0, 19));\n  const [previewIndex, setPreviewIndex] = useState(-1);\n  const [previewDataDay, setPreviewDataDay] = useState(null);\n  const [previewDataWeek, setPreviewDataWeek] = useState();\n  const currentTime = currentTimeExact.substring(0, 16);\n  const [currentCoords, setCoords] = useLocation(null);\n  const [currentCity, setCurrentCity] = useState();\n  const url = currentCoords && `https://api.open-meteo.com/v1/forecast?latitude=${currentCoords[0]}&longitude=${currentCoords[1]}&hourly=temperature_2m,weathercode&daily=temperature_2m_max,temperature_2m_min,apparent_temperature_max,apparent_temperature_min,precipitation_sum,rain_sum,showers_sum,snowfall_sum,windspeed_10m_max,windgusts_10m_max,winddirection_10m_dominant&timezone=Europe%2FBerlin`;\n  const [inputCity, setInputCity] = useState(\"\");\n  const [locationURL, setLocationURL] = useDebounce(`https://geocoding-api.open-meteo.com/v1/search?name=${inputCity}&count=5`, 300);\n  const locations = useFetchLocation(locationURL);\n  const allData = useFetch(url);\n  useEffect(() => {\n    if (previewIndex == -1 || allData === null) {\n      setPreviewDataDay(null);\n    } else if (allData != null) {\n      const newPreviewData = getHourPreviews(allData.hourly, allData.hourly.time[previewIndex]);\n      setPreviewDataDay({\n        previewData: newPreviewData,\n        headline: getDayFromString(allData.hourly.time[previewIndex]) + \" - Ganzer Tag\"\n      });\n    }\n  }, [previewIndex, allData]);\n  useEffect(() => {\n    if (previewIndex == -1 && allData != null) {\n      setPreviewDataWeek({\n        previewData: getDayPreviews(allData.daily),\n        headline: \"Diese Woche\"\n      });\n    }\n  }, [previewIndex, allData]);\n  useEffect(() => {\n    console.log(\"coords changed to \", currentCoords);\n  }, [currentCoords]);\n  useInterval(() => setCurrentTimeExact(addHours(timeZoneOffset + 1 / 60, new Date(currentTime)).toISOString().substring(0, 19)), 60000);\n\n  function getIconURL(code) {\n    let weatherType = getWeatherType(code);\n    weatherType = weatherType === WeatherType.FREEZING_RAIN ? WeatherType.RAIN : weatherType;\n    return `./assets/icons/${weatherType}.svg`;\n  }\n\n  function getBackgroundUrl(code) {\n    let weatherType = getWeatherType(code);\n    weatherType = weatherType === WeatherType.FREEZING_RAIN ? WeatherType.RAIN : weatherType;\n    let url = `url(./assets/backgrounds/${weatherType}.png)`;\n    return url;\n  }\n\n  function roundTime(currentTime) {\n    return currentTime.substring(0, 14) + \"00\";\n  }\n\n  function changePreviewIndex(day) {\n    let index = allData ? allData.hourly.time.indexOf(day) : 0;\n    setPreviewIndex(index);\n  }\n\n  getDayFromDate(new Date(Date.now()));\n  if (!allData) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"loader\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 26\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app screen-overlay\",\n    style: {\n      backgroundImage: getBackgroundUrl(allData.hourly.weathercode[allData.hourly.time.indexOf(roundTime(currentTime))])\n    },\n    children: [/*#__PURE__*/_jsxDEV(MainPart, {\n      currentTime: currentTime,\n      getWeatherStatus: getWeatherStatus,\n      hourly: allData.hourly,\n      getIconURL: getIconURL\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(LocationBar, {\n      setLocationInput: setInputCity,\n      cities: locations,\n      setCurrentCoords: setCoords\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ForeCast, {\n      castType: CastType.HOURLY,\n      previewData: getHourPreviews(allData.hourly),\n      changePreviewIndex: changePreviewIndex,\n      headline: \"Rest des Tages\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ForeCast, {\n      castType: CastType.DAILY,\n      previewData: previewDataWeek ? previewDataWeek.previewData : null,\n      changePreviewIndex: changePreviewIndex,\n      headline: previewDataWeek ? previewDataWeek.headline : \"\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ForeCast, {\n      previewData: previewDataDay ? previewDataDay.previewData : null,\n      castType: CastType.FULLDAY,\n      changePreviewIndex: changePreviewIndex,\n      headline: previewDataDay ? previewDataDay.headline : \"\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 9\n  }, this);\n}\n\n_s(App, \"+FLq82cViq/TihkGfaFVziuCoD0=\", false, function () {\n  return [useLocation, useDebounce, useFetchLocation, useFetch, useInterval];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","MainPart","CastType","ForeCast","useFetch","useFetchLocation","useLocation","getWeatherStatus","getWeatherType","WeatherType","useInterval","timeZoneOffset","addHours","getDayPreviews","getHourPreviews","getDayFromDate","getDayFromString","LocationBar","useDebounce","App","currentTimeExact","setCurrentTimeExact","toISOString","substring","previewIndex","setPreviewIndex","previewDataDay","setPreviewDataDay","previewDataWeek","setPreviewDataWeek","currentTime","currentCoords","setCoords","currentCity","setCurrentCity","url","inputCity","setInputCity","locationURL","setLocationURL","locations","allData","newPreviewData","hourly","time","previewData","headline","daily","console","log","Date","getIconURL","code","weatherType","FREEZING_RAIN","RAIN","getBackgroundUrl","roundTime","changePreviewIndex","day","index","indexOf","now","backgroundImage","weathercode","HOURLY","DAILY","FULLDAY"],"sources":["/home/bela/TPL/frontend-challenges/js/03_react/weather/src/App.tsx"],"sourcesContent":["import React, {useEffect, useState} from 'react';\nimport './App.css';\nimport \"./components/fore-cast\"\nimport {MainPart} from \"./components/main-part\";\nimport {CastType, ForeCast} from \"./components/fore-cast\";\nimport {useFetch, useFetchLocation} from \"./utils/Hooks/useFetch\";\nimport useLocation from \"./utils/Hooks/useLocation\";\nimport {getWeatherStatus, getWeatherType, WeatherType} from \"./utils/GetWeatherType\";\nimport {useInterval} from \"./utils/Hooks/useInterval\"\nimport {timeZoneOffset} from \"./utils/constant\";\nimport {addHours} from \"./utils/time/addHours\";\nimport {getDayPreviews, getHourPreviews, previewData} from \"./utils/previews/hourPreviews\";\nimport {getDayFromDate, getDayFromString} from \"./utils/time/formatTime\";\nimport {LocationBar} from \"./components/location-bar\";\nimport useDebounce from \"./utils/Hooks/useDebounce\";\n\ninterface previewsData {\n    previewData: previewData[];\n    headline: string;\n}\n\nfunction App() {\n    const [currentTimeExact, setCurrentTimeExact] = useState(addHours(timeZoneOffset).toISOString().substring(0, 19));\n    const [previewIndex, setPreviewIndex] = useState<number>(-1);\n    const [previewDataDay, setPreviewDataDay] = useState<previewsData | null>(null)\n    const [previewDataWeek, setPreviewDataWeek] = useState<previewsData | null>()\n    const currentTime = currentTimeExact.substring(0,16);\n    const [currentCoords, setCoords] = useLocation(null);\n    const [currentCity, setCurrentCity] = useState()\n    const url = currentCoords && `https://api.open-meteo.com/v1/forecast?latitude=${currentCoords[0]}&longitude=${currentCoords[1]}&hourly=temperature_2m,weathercode&daily=temperature_2m_max,temperature_2m_min,apparent_temperature_max,apparent_temperature_min,precipitation_sum,rain_sum,showers_sum,snowfall_sum,windspeed_10m_max,windgusts_10m_max,winddirection_10m_dominant&timezone=Europe%2FBerlin`;\n    const [inputCity, setInputCity] = useState(\"\");\n    const [locationURL, setLocationURL] = useDebounce(`https://geocoding-api.open-meteo.com/v1/search?name=${inputCity}&count=5`, 300);\n    const locations = useFetchLocation(locationURL);\n    const allData = useFetch(url);\n\n    useEffect(() => {\n        if (previewIndex == -1 || allData === null){\n            setPreviewDataDay(null)\n        } else if (allData != null){\n            const newPreviewData = getHourPreviews(allData.hourly, allData.hourly.time[previewIndex]);\n            setPreviewDataDay({previewData: newPreviewData, headline: getDayFromString(allData.hourly.time[previewIndex]) + \" - Ganzer Tag\"});\n        }\n    }, [previewIndex, allData])\n\n    useEffect(() => {\n        if (previewIndex == -1 && allData!=null){\n            setPreviewDataWeek({previewData:getDayPreviews(allData.daily), headline:\"Diese Woche\"})\n        }\n    }, [previewIndex, allData])\n    useEffect(() => {\n        console.log(\"coords changed to \", currentCoords);\n    }, [currentCoords])\n\n    useInterval(() => setCurrentTimeExact(addHours(timeZoneOffset + 1/(60), new Date(currentTime)).toISOString().substring(0,19)), 60000)\n\n\n    function getIconURL(code: number) {\n        let weatherType = getWeatherType(code);\n        weatherType = weatherType === WeatherType.FREEZING_RAIN ? WeatherType.RAIN : weatherType;\n\n        return `./assets/icons/${weatherType}.svg`;\n    }\n\n    function getBackgroundUrl(code: number) {\n        let weatherType = getWeatherType(code)\n        weatherType = weatherType === WeatherType.FREEZING_RAIN ? WeatherType.RAIN : weatherType;\n        let url =  `url(./assets/backgrounds/${weatherType}.png)`;\n        return url;\n    }\n\n    function roundTime(currentTime: string) {\n        return currentTime.substring(0,14) + \"00\";\n    }\n\n    function changePreviewIndex(day: string){\n        let index = allData? allData.hourly.time.indexOf(day): 0;\n        setPreviewIndex(index);\n    }\n\n    getDayFromDate(new Date(Date.now()))\n    if (!allData) return <div className=\"loader\"/>\n    return (\n        <div className=\"app screen-overlay\"\n             style={{backgroundImage: getBackgroundUrl(allData.hourly.weathercode[allData.hourly.time.indexOf(roundTime(currentTime))])}}>\n            <MainPart currentTime={currentTime} getWeatherStatus={getWeatherStatus} hourly={allData.hourly}\n                      getIconURL={getIconURL}/>\n            <LocationBar setLocationInput={setInputCity} cities={locations} setCurrentCoords={setCoords}/>\n            <ForeCast castType={CastType.HOURLY} previewData={getHourPreviews(allData.hourly)} changePreviewIndex={changePreviewIndex} headline={\"Rest des Tages\"}/>\n            <ForeCast castType={CastType.DAILY} previewData={previewDataWeek? previewDataWeek.previewData: null} changePreviewIndex={changePreviewIndex} headline={previewDataWeek? previewDataWeek.headline: \"\"}/>\n            <ForeCast previewData={previewDataDay? previewDataDay.previewData : null} castType={CastType.FULLDAY} changePreviewIndex={changePreviewIndex} headline={previewDataDay? previewDataDay.headline: \"\"}/>\n        </div>);\n}\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}